<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#0f172a">
    <title>A Very Important Question</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Confetti Library -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@1,400;1,600&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Poppins', sans-serif;
            overflow: hidden; /* Prevent scrolling entirely */
            touch-action: none; /* Disables double-tap zoom */
        }
        .font-serif-elegant {
            font-family: 'Playfair Display', serif;
        }
        .animate-float {
            animation: float 6s ease-in-out infinite;
        }
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
            100% { transform: translateY(0px); }
        }
        .glass-panel {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        }
        .fade-in {
            animation: fadeIn 0.8s ease-out forwards;
        }
        .fade-out {
            animation: fadeOut 0.8s ease-in forwards;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fadeOut {
            from { opacity: 1; transform: translateY(0); }
            to { opacity: 0; transform: translateY(-10px); }
        }
        /* Mobile-specific height fix */
        .mobile-h-screen {
            height: 100vh; /* Fallback */
            height: 100dvh; /* Dynamic viewport height for mobile browsers */
        }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 text-white mobile-h-screen selection:bg-pink-500 selection:text-white">

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- CONFIGURATION ---
        const CONFIG = {
            yourName: "Us", 
            herName: "Her", 
            startNode: 'q_vibe',
            // Default generic "cool" transitions
            defaultTransitions: [
                "âœ¨",
                "ðŸ”¥",
                "âš¡",
                "ðŸ’«",
                "ðŸŒ¹"
            ],
            questions: {
                'q_vibe': {
                    text: "First things first. It's Friday night. What is the vibe?",
                    options: [
                        { label: "Cozy Night In ðŸŽ¬", value: "Cozy", next: 'q_cozy', reaction: "âœ¨" },
                        { label: "Adventure Out ðŸŒƒ", value: "Adventure", next: 'q_adventure', reaction: "ðŸš€" },
                        { label: "Dinner Date ðŸ·", value: "Dinner", next: 'q_dinner', reaction: "ðŸ¥‚" },
                        { label: "Chaos & Fun ðŸŽ¢", value: "Chaos", next: 'q_chaos', reaction: "âš¡" }
                    ]
                },
                'q_dinner': {
                    text: "Excellent choice. What are we craving?",
                    options: [
                        { label: "Fried Chicken (CFC) ðŸ—", value: "Fried Chicken", next: 'q_feeling', reaction: "ðŸ—" },
                        { label: "Indian ðŸ›", value: "Indian", next: 'q_feeling', reaction: "ðŸ›" },
                        { label: "Kebab ðŸ¥™", value: "Kebab", next: 'q_feeling', reaction: "ðŸ¥™" },
                        { label: "Home Made (by me) ðŸ‘¨â€ðŸ³", value: "Home Cooking", next: 'q_feeling', reaction: "ðŸ‘¨â€ðŸ³" }
                    ]
                },
                'q_adventure': {
                    text: "Adventure it is. What's the mission?",
                    options: [
                        { label: "Star Gazing âœ¨", value: "Stargazing", next: 'q_feeling', reaction: "âœ¨" },
                        { label: "Night Walk ðŸš¶â€â™‚ï¸", value: "Night Walk", next: 'q_feeling', reaction: "ðŸŒ™" },
                        { label: "City Explore ðŸ™ï¸", value: "City Explore", next: 'q_feeling', reaction: "ðŸ™ï¸" },
                        { label: "Supermarket Tour ðŸ›’", value: "Supermarket Run", next: 'q_feeling', reaction: "ðŸ›’" }
                    ]
                },
                'q_chaos': {
                    text: "Chaos chosen. Select your poison:",
                    options: [
                        { label: "Crous SoirÃ©e ðŸ»", value: "Crous Party", next: 'q_feeling', reaction: "ðŸ»" },
                        { label: "Midnight Mystery Drive ðŸš—", value: "Mystery Drive", next: 'q_feeling', reaction: "ðŸš—" }
                    ]
                },
                'q_cozy': {
                    text: "Cozy mode activated. How do we handle the movie?",
                    options: [
                        { label: "I pick (You trust me) ðŸŽžï¸", value: "You Pick", next: 'q_feeling', reaction: "ðŸŽžï¸" },
                        { label: "You pick (I'll judge) ðŸ¿", value: "She Picks", next: 'q_feeling', reaction: "ðŸ¿" }
                    ]
                },
                'q_feeling': {
                    text: "If someone planned a date just for you, youâ€™d feelâ€¦",
                    options: [
                        { label: "Flattered â˜ºï¸", value: "Flattered", next: 'q_fast_fun', reaction: "ðŸŒ¹" },
                        { label: "Curious ðŸ§", value: "Curious", next: 'q_fast_fun', reaction: "âœ¨" },
                        { label: "Excited ðŸ¤©", value: "Excited", next: 'q_fast_fun', reaction: "ðŸ”¥" },
                        { label: "All of the above ðŸ˜Œ", value: "All of the above", next: 'q_fast_fun', reaction: "ðŸ’«" }
                    ]
                },
                'q_fast_fun': {
                    text: "Quick choices. Donâ€™t overthink.",
                    options: [
                        { label: "Coffee â˜•", value: "Coffee", next: 'q_music', reaction: "â˜•" },
                        { label: "Walk with no destination ðŸŒ™", value: "Night Walk", next: 'q_music', reaction: "ðŸŒ™" }
                    ]
                },
                'q_music': {
                    text: "Be honest... who has better taste in music?",
                    options: [
                        { label: "Me (Obviously) ðŸŽ§", value: "Her Choice", next: 'q_fun', reaction: "ðŸŽ§" },
                        { label: "You (Rarely) ðŸŽ¸", value: "My Choice", next: 'q_fun', reaction: "ðŸŽ¸" }
                    ]
                },
                'q_fun': {
                    text: "Critical analysis: How fun am I?",
                    options: [
                        { label: "Fun ðŸ¥³", value: "Fun", next: 'q_hypothetical', reaction: "ðŸ¥³" },
                        { label: "Super Fun ðŸš€", value: "Super Fun", next: 'q_hypothetical', reaction: "ðŸš€" },
                        { label: "Very Fun âš¡", value: "Very Fun", next: 'q_hypothetical', reaction: "âš¡" },
                        { label: "Lame (JK) ðŸ˜", value: "Lame (JK)", next: 'q_hypothetical', reaction: "ðŸ˜" }
                    ]
                },
                'q_hypothetical': {
                    text: "Hypothetically speakingâ€¦ If I planned something simple but thoughtful, youâ€™d be more likely to sayâ€¦",
                    options: [
                        { label: "We can ðŸ˜Œ", value: "We can", next: 'finish', reaction: "âœ¨" },
                        { label: "When & Where? ðŸ“", value: "When-Where", next: 'finish', reaction: "ðŸ“" },
                        { label: "Hmm okay ðŸ§", value: "Hmm okay", next: 'finish', reaction: "ðŸ”¥" },
                        { label: "Wateva less do it ðŸ¤™", value: "Wateva", next: 'finish', reaction: "ðŸ¤™" }
                    ]
                }
            }
        };

        const App = () => {
            const [currentStepId, setCurrentStepId] = useState('login'); 
            const [name, setName] = useState(CONFIG.herName);
            const [inputName, setInputName] = useState('');
            const [answers, setAnswers] = useState({});
            const [history, setHistory] = useState([]); 
            
            // New Transition State
            const [isTransitioning, setIsTransitioning] = useState(false);
            const [transitionText, setTransitionText] = useState("");
            
            // Valentine Turn State
            const [valentinePhase, setValentinePhase] = useState(0);

            const [noBtnStyle, setNoBtnStyle] = useState({});
            const [yesBtnScale, setYesBtnScale] = useState(1);
            const [loadingText, setLoadingText] = useState("Analyzing compatibility...");

            const handleAnswer = (value, nextNode, customReaction) => {
                // Save answer
                setAnswers(prev => ({...prev, [currentStepId]: value}));
                setHistory([...history, currentStepId]);

                // Trigger Transition
                // Use specific reaction if available, otherwise pick a random "cool" one
                const reaction = customReaction || CONFIG.defaultTransitions[Math.floor(Math.random() * CONFIG.defaultTransitions.length)];
                
                setTransitionText(reaction);
                setIsTransitioning(true);

                // Wait 1.5 seconds before showing next question
                setTimeout(() => {
                    setIsTransitioning(false);
                    if (nextNode === 'finish') {
                        setCurrentStepId('loading');
                    } else {
                        setCurrentStepId(nextNode);
                    }
                }, 1500);
            };

            useEffect(() => {
                if (currentStepId === 'loading') {
                    const texts = [
                        "Calculating compatibility...",
                        "Analyzing food preferences...",
                        "Checking astrological alignment...",
                        "Consulting the oracle...",
                        "Conclusion reached: MATCH FOUND."
                    ];
                    let i = 0;
                    const interval = setInterval(() => {
                        setLoadingText(texts[i]);
                        i++;
                        if (i >= texts.length) {
                            clearInterval(interval);
                            setTimeout(() => setCurrentStepId('valentine_turn'), 1000);
                        }
                    }, 800);
                }
            }, [currentStepId]);

            // THE VALENTINE TURN LOGIC
            useEffect(() => {
                if (currentStepId === 'valentine_turn') {
                    // Sequence timing
                    const times = [2000, 2500, 2500, 3000]; // Duration for each phrase
                    let i = 0;
                    
                    const runSequence = () => {
                        if (i < 4) {
                            setValentinePhase(i + 1);
                            setTimeout(() => {
                                i++;
                                runSequence();
                            }, times[i]);
                        } else {
                            setTimeout(() => setCurrentStepId('proposal'), 1000);
                        }
                    };
                    
                    runSequence();
                }
            }, [currentStepId]);

            const moveNoButton = (e) => {
                if(e && e.preventDefault) e.preventDefault();
                
                const buttonWidth = 100;
                const buttonHeight = 50;
                const maxX = window.innerWidth - buttonWidth - 20;
                const maxY = window.innerHeight - buttonHeight - 20;
                
                const x = Math.max(20, Math.random() * maxX);
                const y = Math.max(20, Math.random() * maxY);
                
                setNoBtnStyle({
                    position: 'absolute',
                    left: `${x}px`,
                    top: `${y}px`,
                    transition: 'all 0.15s ease-out',
                    zIndex: 50
                });
                setYesBtnScale(prev => Math.min(prev + 0.15, 3));
            };

            const handleYes = () => {
                confetti({
                    particleCount: 150,
                    spread: 70,
                    origin: { y: 0.6 },
                    colors: ['#ff69b4', '#ffffff', '#818cf8']
                });
                setCurrentStepId('success');
            };

            // --- RENDER LOGIC ---

            // 0. Login Screen
            if (currentStepId === 'login') {
                return (
                    <div className="flex flex-col items-center justify-center mobile-h-screen px-6 text-center relative">
                        <div className="glass-panel p-8 rounded-3xl animate-float w-full max-w-sm">
                            <h1 className="text-2xl font-bold mb-6 text-pink-300">
                                Restricted Access ðŸ”’
                            </h1>
                            <p className="text-gray-200 mb-6">
                                Please identify yourself to proceed.
                            </p>
                            <input 
                                type="text" 
                                placeholder="Enter your name"
                                value={inputName}
                                onChange={(e) => setInputName(e.target.value)}
                                className="w-full bg-white/10 border border-white/30 rounded-xl px-4 py-3 text-center text-white placeholder-white/50 mb-6 focus:outline-none focus:border-pink-500 transition-all"
                            />
                            <button 
                                onClick={() => {
                                    if(inputName.trim()) {
                                        setName(inputName);
                                        setCurrentStepId('intro');
                                    }
                                }}
                                className="w-full bg-white text-purple-900 font-bold py-3 px-8 rounded-xl text-lg hover:bg-pink-100 transition-all shadow-lg active:scale-95 disabled:opacity-50"
                                disabled={!inputName.trim()}
                            >
                                Enter &rarr;
                            </button>
                        </div>
                        <div className="absolute bottom-6 text-[10px] text-white/30 font-mono tracking-widest uppercase">
                            Developed by Ashif @as_if_youknowme
                        </div>
                    </div>
                );
            }

            // 1. Intro Screen
            if (currentStepId === 'intro') {
                return (
                    <div className="flex flex-col items-center justify-center mobile-h-screen px-6 text-center relative">
                        <div className="glass-panel p-8 rounded-3xl animate-float w-full max-w-sm">
                            <h1 className="text-4xl font-extrabold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-pink-400 to-purple-400">
                                Hey {name} ðŸ‘‹
                            </h1>
                            <p className="text-lg text-gray-200 mb-8 leading-relaxed">
                                I have a very important question, but I need to collect some data first.
                                <br/><br/>
                                <span className="text-sm opacity-75">(Don't worry, it's painless)</span>
                            </p>
                            <button 
                                onClick={() => setCurrentStepId(CONFIG.startNode)}
                                className="w-full bg-white text-purple-900 font-bold py-4 px-8 rounded-2xl text-xl hover:bg-pink-100 transition-all shadow-lg active:scale-95"
                            >
                                Let's Start &rarr;
                            </button>
                        </div>
                        <div className="absolute bottom-6 text-[10px] text-white/30 font-mono tracking-widest uppercase">
                            Developed by Ashif @as_if_youknowme
                        </div>
                    </div>
                );
            }

            // TRANSITION SCREEN (Interstital Micro-Copy)
            if (isTransitioning) {
                return (
                    <div className="flex flex-col items-center justify-center mobile-h-screen px-4 text-center">
                        <div className="fade-in">
                            <h2 className="text-7xl animate-bounce">
                                {transitionText}
                            </h2>
                            <div className="mt-12 flex justify-center">
                                <div className="w-12 h-1 bg-white/30 rounded-full overflow-hidden">
                                    <div className="h-full bg-pink-400 animate-[width_1.5s_ease-in-out_forwards]" style={{width: '0%'}}></div>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            // 2. Dynamic Question Screens
            if (CONFIG.questions[currentStepId]) {
                const currentQ = CONFIG.questions[currentStepId];
                const progress = history.length + 1;
                
                return (
                    <div className="flex flex-col items-center justify-center mobile-h-screen px-4 fade-in">
                        <div className="w-full max-w-sm">
                            <div className="mb-8 flex justify-between items-center text-xs uppercase tracking-widest opacity-50 font-bold">
                                <span>Question {progress}</span>
                                <span>Pending...</span>
                            </div>
                            
                            <h2 className="text-2xl font-bold mb-10 leading-snug">{currentQ.text}</h2>
                            
                            <div className="space-y-4">
                                {currentQ.options.map((opt, idx) => (
                                    <button 
                                        key={idx}
                                        onClick={() => handleAnswer(opt.value, opt.next, opt.reaction)}
                                        className="w-full glass-panel text-left p-5 rounded-2xl hover:bg-white/20 transition-all active:scale-95 border border-transparent hover:border-pink-500 flex items-center group"
                                    >
                                        <span className="text-2xl mr-4">
                                            {opt.label.split(' ').pop()}
                                        </span>
                                        <span className="font-semibold text-lg">
                                            {opt.label.replace(opt.label.split(' ').pop(), '')}
                                        </span>
                                    </button>
                                ))}
                            </div>
                        </div>
                    </div>
                );
            }

            // 3. Loading Screen
            if (currentStepId === 'loading') {
                return (
                    <div className="flex flex-col items-center justify-center mobile-h-screen text-center px-4">
                        <div className="w-20 h-20 border-4 border-pink-500 border-t-transparent rounded-full animate-spin mb-8"></div>
                        <h2 className="text-xl font-semibold animate-pulse">{loadingText}</h2>
                    </div>
                );
            }

            // 3.5 THE VALENTINE TURN (Cinematic Text Sequence)
            if (currentStepId === 'valentine_turn') {
                return (
                    <div className="flex flex-col items-center justify-center mobile-h-screen text-center px-6">
                        {valentinePhase === 1 && (
                            <h1 className="text-4xl font-extrabold italic fade-in">Feb 14 is coming up.</h1>
                        )}
                        {valentinePhase === 2 && (
                            <h1 className="text-4xl font-extrabold italic fade-in">No pressure.</h1>
                        )}
                        {valentinePhase === 3 && (
                            <h1 className="text-4xl font-extrabold italic fade-in">Just a good excuse...</h1>
                        )}
                        {valentinePhase === 4 && (
                            <h1 className="text-4xl font-extrabold italic fade-in">To do something fun.</h1>
                        )}
                    </div>
                );
            }

            // 4. THE ASK (Invitation)
            if (currentStepId === 'proposal') {
                return (
                    <div className="flex flex-col items-center justify-center mobile-h-screen px-4 text-center overflow-hidden relative w-full fade-in">
                        
                        <div className="glass-panel p-8 rounded-3xl max-w-sm w-full relative z-20 border border-white/30">
                            <h1 className="text-4xl font-extrabold leading-tight mb-2 text-white">
                                So let's go hang out, girl. ðŸ¤™
                            </h1>
                            <p className="text-lg opacity-80 mb-8 font-medium">
                                We'll see how things go. No stress.
                            </p>
                            
                            <div className="flex flex-col gap-5 items-center justify-center w-full relative h-32">
                                {/* YES BUTTON */}
                                <button 
                                    onClick={handleYes}
                                    style={{ transform: `scale(${yesBtnScale})` }}
                                    className="w-full bg-gradient-to-r from-pink-500 to-purple-600 text-white font-black py-4 px-6 rounded-xl text-2xl shadow-lg hover:shadow-pink-500/50 transition-all active:scale-95 z-10 uppercase tracking-wider"
                                >
                                    Lessgooo ðŸš€
                                </button>

                                {/* NO BUTTON (RUNAWAY) */}
                                <button 
                                    style={noBtnStyle}
                                    onMouseEnter={moveNoButton} 
                                    onTouchStart={moveNoButton} 
                                    className="bg-gray-800 text-gray-400 font-bold py-3 px-8 rounded-xl text-lg transition-all border border-gray-600 uppercase tracking-widest"
                                >
                                    Nah
                                </button>
                            </div>
                        </div>
                        
                    </div>
                );
            }

            // 5. Success Screen
            if (currentStepId === 'success') {
                const activity = answers['q_vibe'];
                const detail = answers['q_dinner'] || answers['q_adventure'] || answers['q_chaos'] || "Movie Night";

                return (
                    <div className="flex flex-col items-center justify-center mobile-h-screen px-4 text-center fade-in">
                        <div className="glass-panel p-8 rounded-3xl animate-float w-full max-w-sm">
                            <div className="text-6xl mb-6">ðŸ¥‚ðŸŒ¹âœ¨</div>
                            <h1 className="text-3xl font-extrabold mb-4 font-serif-elegant">It's a Date.</h1>
                            <p className="text-md text-gray-200 mb-8">
                                I'll pick you up. Wear something nice.
                            </p>
                            <div className="bg-white/10 p-4 rounded-xl text-left text-xs font-mono space-y-2 mb-8">
                                <p className="opacity-75">// Validated:</p>
                                <p>Plan: <span className="text-pink-400 font-bold">{detail}</span></p>
                                <p>Mood: <span className="text-purple-400 font-bold">{activity}</span></p>
                                <p>Status: <span className="text-green-400 font-bold">CONFIRMED</span></p>
                            </div>
                            <button 
                                className="text-sm opacity-50 border border-white/30 rounded-full px-4 py-2"
                                onClick={() => {
                                    alert("Take a screenshot and send it to me!");
                                }}
                            >
                                ðŸ“¸ Screenshot this
                            </button>
                        </div>
                    </div>
                );
            }
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>